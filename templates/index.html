
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AI Lecture Assistant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 720px; margin: 40px auto; padding: 0 16px; }
      .card { border: 1px solid #ddd; border-radius: 12px; padding: 24px; }
      input[type=file] { margin-top: 8px; }
      button { padding: 10px 16px; border-radius: 8px; border: 1px solid #ccc; background: #f7f7f7; cursor: pointer; }
      .result { margin-top: 16px; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; 
      white-space: pre-wrap;   /* Wrap long lines */
      word-wrap: break-word;   /* Ensure words break instead of overflowing */
      overflow-wrap: break-word; }
    </style>
  </head>
  <body>
    <h1>AI Lecture Assistant</h1>
    <div class="typewriter-container">
        <span id="typewriter-text" class="typewriter">
            Upload a lecture audio file. The server will transcribe it, summarize it, and create a Doc file.
        </span>
    </div>
    <div class="card">
      <form id="uploadForm">
        <input type="file" name="file" accept=".mp3,.wav,.m4a,.aac,.flac,.ogg" required />
        <br><br>
        <button type="submit">Upload & Process</button>
      </form>
      <div id="result" class="result">Nothing to process</div>
    </div>

    <script>
      const form = document.getElementById('uploadForm');
      const result = document.getElementById('result');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        result.textContent = "Processing... this can take a few minutes for long audio.";
        const fd = new FormData(form);
        try {
          const res = await fetch('/upload', { method: 'POST', body: fd });
          const data = await res.json();
          if (!res.ok) throw new Error(data.error || 'Error');
          result.innerHTML = `<p><strong>Success!</strong></p>
            <p>Google Doc: <a target="_blank" href="${data.google_doc_url}">${data.google_doc_url}</a></p>
            <p><strong>Summary preview:</strong></p>
            <pre class="mono">${data.summary_preview}</pre>`;

        } catch (err) {
          result.innerHTML = "<p style='color:red'>Error: " + err.message + "</p>";
        }
      });
    </script>
  </body>
</html>
